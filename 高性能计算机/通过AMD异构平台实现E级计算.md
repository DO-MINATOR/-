### 摘要

AMD的E级计算前景，提出了软硬件协同计算的挑战，和当前做出的努力

### 绪论

第一台P级（10^15^）超算机在2008年实现，截至2020年6月，最快的超算Fugaku的峰值运行速度达到513.854*10^15^次浮点运算，这些高性能计算系统执行大量的计算，以推动重要的科学实验，从而设计出更高效的燃料和发动机，更安全的桥梁和建筑，从模拟全球气候，到探索宇宙的起源，超算发挥了越来越重要的作用。下一代将要实现的是E级（10^18^）浮点运算，包含100000个互联的计算节点，平均每个计算节点需实现10T（10^13^）次浮点运算，但现代的高端显卡计算速度最多达到该目标的2/3。

目前的挑战在于，系统的内存容量、传输速率、电源功率必须提高几个数量级，另外节点数量众多，因此还要保证系统的可靠性和可扩展性。

### AMD对于E级超算的展望

系统包括硬件资源和软件资源（编写、调优执行程序）

![image-20201111174008391](https://imagebag.oss-cn-chengdu.aliyuncs.com/img/image-20201111174008391.png)

- a：通过网络互连的机柜
- b：机柜内部包括多个计算节点，顶部有交换机和IO处理机
- c：基于硅介质的APU和多个3D架构的存储器，

通常a、b两个部分大同小异，主要能体现AMD计算平台的优势在于c的设计。

**APU采用通用高吞吐量管道**，实现性能和能源效率的平衡，结合了高性能多核CPU，提升单线程处理水平。其设计思路是，GPU实现大规模、高吞吐量的计算，CPU实现那些难以并行处理的程序，并为历史遗留软件提供支持。AMD异构平台还包括内存的异构，**通过结合DRAM和NVM实现高带宽和低耗能**，Heterogeneous System Architecture（HSA）异构平台通过网络**network interface controller（NIC高带宽、低开销）**与其他节点互联，并对外提供硬件和软件接口（生态系统），以使编程人员能够有效发挥超算机的最大效能。

### APU架构

异构APU方法提供了高吞吐量、高效的GPU资源与为单线程性能而优化的CPU。

异构平台提供了一个统一的虚拟内存空间，这样CPU、GPU快速的传输数据（交换指针），从而避免了昂贵的操作（PCIE传输、数据格式重新编码，内存分配等）。以往的异构计算，所有的控制流都需要经过CPU，使得CPU及其传输通道成为了瓶颈，而AMD提供了硬件级的任务队列，使得GPU可以直接取得任务并生成执行线程，避免了与CPU的交互，同时提升了编程效率。**（对比英伟达的CUDA计算模型）**

相较于传统的CPU、GPU松耦合的离散计算模型，将CPU-GPU集成起来的优势在于：

1. 降低数据传输的能耗、延迟
2. 更容易动态切换功耗
3. 避免显示的同步操作，降低编程复杂性
4. 更高的性能/面积比

E级计算机为充分实现其价值，必须以非针对特定应用的形式实现。

EHP提供了统一地址空间和一致性协议，但传统的协议通信开销仍然较大，**因此提出了一种新的同步机制QuickRelease**，实现了GPU线程间的轻量级同步。另外，定义了**内存一致性模型框架HRF**，给编程人员提供了良好的管理内存空间的工具。提出了**异构系统一致性协议HSC**，在区域上（如1KB）管理一致性，而不是缓存块上（64B）管理一致性。上述三种方法大大提高了APU的运行效率。

### 内存架构

内存容量和带宽大小十分重要，美国能源部对E级超算的要求：每个节点提供4TB的带宽大小，1Tb的存储容量。但普遍认为容量目标难以实现。例如：JEDEC高带宽内存HBM标准，3D堆叠内存堆叠架构，每层提供128GB的访问带宽，一共8层，可以到达1tB访问带宽。然而HBM的每层只能提供2Gb的，8层一共是16Gb，里1Tb的目标存储容量差16倍。

