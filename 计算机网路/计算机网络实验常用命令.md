### 交换机和路由器基本配置

console连接：使用xshell直接连接或者通过超级终端

![image-20200926125417641](https://imagebag.oss-cn-chengdu.aliyuncs.com/img/image-20200926125417641.png)

参观级到管理级：system-view

管理级到参观级：ctrl+z

进入某以太口：interface ethernet 1/0/1（具体是gigabitethernet以及0/1不同设备不同，需要手动尝试）

退出：quit

显示当前配置：display current-configuration / ctrl+g

清除配置：reset saved-configuration 

### 链路层与网络层

设置端口网络ip地址和掩码：ip address xxx.xxx.x.x 24

设置MTU：mtu 100

关闭以太口：shutdown

开启以太口：undo shutdown

开启stp协议：stp enable

全双工模式：dup full

设置速率：speed 100

端口聚合：link-aggregation e0/1 to e0/2 both

设置端口链路类型：port link-type [access/trunk/hybrid]

清除链路类型：undo port link-type

设置vlan：vlan 2

向vlan添加端口：进入vlan视图后，直接添写端口号port e 1/0/1

移除vlan中端口：进入vlan视图后，undo port e 1/0/1

划分vlan的网关：首先进入vlan所有的interface，如int vlan 2，然后再使用ip address xxx配置ip和网关

指定trunk端口通过vlanid：port trunk permit vlan 2 3

设定hybrid端口vlan：port hybrid vlan 2 tagged  ；port hybrid vlan 3 untagged

查看mac表：display mac-display

清空mac表：undo mac-display

启动ppp协议：link-protocol ppp

开启ppp的debug功能（LCP）：debugging ppp lcp all

显示debug信息：terminal debugg

查看arp缓存：arp -a

清空arp缓存（主机）：arp -d

清空arp缓存（路由器）：reset arp

设置链路包大小：mtu x，单位字节

ping包大小：ping -s 100 192....

查看ip-route表：display ip routing-table

添加路由表项：ip rou xxx.xxx.x.x 24

### OSPF协议

配置路由器ID： router id xxx

取消路由器ID：undo router id

启动ospf协议进程：ospf

关闭ospf协议进程：undo ospf

划分区域id：area xxx

删除区域id：undo area xxx

指定网段使能ospf：network ip-address mask，注意ospf的mask配置刚好相反

重启ospf：reset ospf pro

显示ospf：dis ospf brief

显示ospf邻接：dis ospf peer

显示ospf路由表信息：dis ospf rou

显示ospf interface信息：dis ospf int

配置路由回环：int loop ？

开启ospf调试信息：debugging ospf event

打开调试视图：terminal debugging

向ospf引入外部路由：import-route static

查看第二类ospf：display ospf lsdb network

查看第三类ospf：display ospf lsdb summary

查看第四类ospf：display ospf lsdb asbr

查看第五类ospf：display ospf lsdb ase

配置ospf的cost：进入相应接口，然后ospf cost 100，注意与之相连的接口同样也要做相同配置

通过画出待测路由器到各点的距离并综合起来，可以得出整幅图的单源最短路径，结合tracert检验计算结果

### BGP

启动BGP，并输入编号：bgp 100

输入对等体及其所在AS编号：peer 1.1.1.2 as-number 300

使能邻居：peer 1.1.1.2 enable

强制下一跳为本身接口：peer 3.1.1.2 next-hop-local（使得从EBGP获得的路由信息在转发给其他IBGP时有明确的下一跳地址）

将网段信息注入到BGP中，进入bgp视图：network 5.5.5.5 255.255.255.255

将ip地址作为源地址发送ping报文：ping-a 5.5.5.5 4.4.4.4

开启bgp调试功能：debug bgp event

打开调试视图：terminal debugging

重启bgp协议：reset bgp all

查看邻居状态：display bgp peer

查看bgp路由：display bgp rou

路由聚合，在bgp视图中：aggregate 192.168.0.0 255.255.0.0

路由聚合（但不配置具体路由），在bgp视图中：aggregate 192.168.0.0 255.255.0.0 detail-suppressed

向BGP引入路由信息：import-route direct



进入acl（基本）访问控制列表：acl number 2001

规则x设置禁止访问网段：rule 0 deny source 18.0.0.0 0.255.255.255

规则y设置任意网段通过：rule 1 permit source 0.0.0.0 255.255.255.255（掩码相反）

应用该acl：peer 10.0.0.1 filter-policy 2001 export



设置基于AS-PATH的过滤规则：ip as-path-acl 1 permit ^$

进入bgp视图，应用此过滤规则：peer 10.0.0.1 as-path-acl 1export



路由策略，基于ACL进行配置：route-policy deny6 permit 10

如果匹配某一项：if-match acl 2001

就修改某一属性：apply cost 888

对等体应用此策略：peer 1.1.1.2 route-policy 得ny export

